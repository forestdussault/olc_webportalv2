{% extends "base.html" %}

{% block content %}
    <br>
    <div class="container" align="center">
        <div class="form-control">
            <h4> <strong>Project Title:</strong> {{ project_id.project_title }}</h4>
            <h5> <strong>Date Created:</strong> {{ project_id.date }}</h5>
        </div>

        {#Main table for displaying project metadata#}
        <br>
        <div id="project-table" class="form-control">
            {% include 'projects/project_table.html' %}
        </div>

        {#Table for displaying statuses of jobs requested#}
        <br>
        <div id="job-status-table" class="form-control">
            {% include 'projects/job_status_table.html' %}
        </div>

        {#Table for displaying genesippr results once they are complete#}
{#        {% if project_id.genesippr_status == 'Complete' %}#}
        <br>
            <div id="genesippr-results-table" class="form-control">

                    {% include 'projects/genesippr_results_table.html' %}
{#                {% else %}#}
{#                    <h5>GenesipprV2 Results</h5>#}
{#                    <div class="progress">#}
{#                        <div class="progress-bar bg-info progress-bar-striped progress-bar-animated" role="progressbar" style="width: 100%; height: 25px; font-size: medium; line-height: 25px" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">#}
{#                            Pending#}
{#                        </div>#}
{#                    </div>#}

            </div>
{#        {% endif %}#}

        {#Table for displaying sendsketch results once they are complete#}
        <br>
{#        {% if project_id.sendsketch_status == 'Complete' %}#}
        <div id="sendsketch-results-table" class="form-control">

                {% include 'projects/sendsketch_results_table.html' %}
{#                {% else %}#}
{#                    <h5>Sendsketch Results</h5>#}
{#                    <div class="progress">#}
{#                        <div class="progress-bar bg-info progress-bar-striped progress-bar-animated" role="progressbar" style="width: 100%; height: 25px; font-size: medium; line-height: 25px" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">#}
{#                            Pending#}
{#                        </div>#}
{#                    </div>#}
        </div>
{#        {% endif %}#}

    </div>

    <script type="text/javascript">
        function loadTables() {
            jQuery(document).ready(function(){
                jQuery("#project-table").load("project_table");
                jQuery("#genesippr-results-table").load("genesippr_results_table");
                jQuery("#sendsketch-results-table").load("sendsketch_results_table");
                jQuery("#job-status-table").load("job_status_table");
            });
        }

        //Immediately load the tables
        setTimeout(function() {
            console.log('Initial table loading');
            loadTables();
        }, 1); //

        //Periodically load the tables if and job status == 'Processing'

        setInterval(function() {
            {% if project_id.genesippr_status == 'Processing' or project_id.sendsketch_status == 'Processing' %}
                console.log('Loading...')
                loadTables();
            {% endif %}
        }, 5000); // This reloads the <div> every 5 seconds.

    </script>

{% endblock content %}
